/**
 * –ë–õ–û–ö 1: –ó–ê–ö–†–Ü–ü–õ–ï–ù–ù–Ø (–¢–≤—ñ–π "–±–æ—Ä–≥" –∑–∞ –º–∏–Ω—É–ª—ñ –¥–Ω—ñ)
 * –°–ø—Ä–æ–±—É–π –Ω–∞–ø–∏—Å–∞—Ç–∏ —ó—Ö, –Ω–µ –ø—ñ–¥–≥–ª—è–¥–∞—é—á–∏ —É –≤—á–æ—Ä–∞—à–Ω—ñ–π –∫–æ–¥.
 */

// 1. Promise.all (–ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏–π –º–µ–Ω–µ–¥–∂–µ—Ä)
// –£–º–æ–≤–∞: –ù–∞–ø–∏—à–∏ —Ñ—É–Ω–∫—Ü—ñ—é getAllProducts(ids), —è–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç—å —É—Å—ñ —Ç–æ–≤–∞—Ä–∏ –û–î–ù–û–ß–ê–°–ù–û.
const fetchProduct = (id) => {
  return new Promise((res, rej) => {
    setTimeout(() => (id > 0 ? res(`–¢–æ–≤–∞—Ä ${id}`) : rej("–ü–æ–º–∏–ª–∫–∞ ID")), 1000);
  });
};
const productIds = [10, 20, 30];

// –¢–≤—ñ–π –∫–æ–¥ —Ç—É—Ç...

const getAllProducts = async (ids) => {
  const products = [];
  for (const id of ids) {
    products.push(fetchProduct(id));
  }

  return await Promise.all(products);
};

console.log(getAllProducts(productIds));
// 2. –ö–æ–Ω—Ç–µ–∫—Å—Ç (this)
// –£–º–æ–≤–∞: –í–∏–ø—Ä–∞–≤ —Ñ—É–Ω–∫—Ü—ñ—é —Ç–∞–∫, —â–æ–± –≤–æ–Ω–∞ –≤–∏–≤–µ–ª–∞ "MacBook" —á–µ—Ä–µ–∑ —Å–µ–∫—É–Ω–¥—É (2 –≤–∞—Ä—ñ–∞–Ω—Ç–∏: bind —Ç–∞ —Å—Ç—Ä—ñ–ª–æ—á–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è).
const laptop = {
  brand: "MacBook",
  showBrandDelayed: function () {
    setTimeout(
      () => {
        console.log(this.brand);
      },
      //   function () {
      //     console.log(this.brand);
      //   }.bind(this),
      1000,
    );
  },
};

// –¢–≤—ñ–π –∫–æ–¥ —Ç—É—Ç...
laptop.showBrandDelayed();

// 3. Memoize (–ö–µ—à—É–≤–∞–Ω–Ω—è)
// –£–º–æ–≤–∞: –°—Ç–≤–æ—Ä–∏ —Ñ—É–Ω–∫—Ü—ñ—é, —è–∫–∞ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–º—É –≤–∏–∫–ª–∏–∫—É –∑ —Ç–∏–º —Å–∞–º–∏–º —á–∏—Å–ª–æ–º –±–µ—Ä–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —ñ–∑ –∫–µ—à—É.
function createMultiplier(factor) {
  const cache = {};

  return function (num) {
    if (num in cache) {
      return cache[num];
    } else {
      let result = factor * 5;
      cache[num] = result;
      return result;
    }
  };
  // –¢–≤—ñ–π –∫–æ–¥ —Ç—É—Ç...
}

const multiply5 = createMultiplier(5);
console.log(multiply5(5));
console.log(multiply5(5));

// 4. GroupBy (–ì—Ä—É–ø—É–≤–∞–Ω–Ω—è)
// –£–º–æ–≤–∞: –ó–≥—Ä—É–ø—É–π –º–∞—Å–∏–≤ —é–∑–µ—Ä—ñ–≤ –∑–∞ —ó—Ö —Ä–æ–ª—è–º–∏.
const users = [
  { name: "–û–ª–µ–∫—Å—ñ–π", role: "admin" },
  { name: "–ú–∞—Ä—ñ—è", role: "user" },
  { name: "–Ü–≤–∞–Ω", role: "admin" },
  { name: "–î–∞—Ä–∏–Ω–∞", role: "user" },
];

function groupByRole(users) {
  const filterObj = {};

  for (const user of users) {
    const userName = user.name;
    const role = user.role;
    if (role in filterObj) {
      filterObj[role].push(userName);
    } else {
      filterObj[role] = [userName];
    }
  }
  return filterObj;
}

console.log(groupByRole(users));

// –¢–≤—ñ–π –∫–æ–¥ —Ç—É—Ç...

// 5. Deep Flatten (–†–µ–∫—É—Ä—Å—ñ—è)
// –£–º–æ–≤–∞: –ù–∞–ø–∏—à–∏ —Ñ—É–Ω–∫—Ü—ñ—é, —è–∫–∞ —Ä–æ–±–∏—Ç—å –±—É–¥—å-—è–∫–∏–π –≤–∫–ª–∞–¥–µ–Ω–∏–π –º–∞—Å–∏–≤ –ø–ª–æ—Å–∫–∏–º.
const nestedArray = [1, [2, [3, [4]], 5]];

// –¢–≤—ñ–π –∫–æ–¥ —Ç—É—Ç...

const deepFlatten = (nestedArray) => {
  let flatArr = [];

  for (const element of nestedArray) {
    if (Array.isArray(element)) {
      let flattenElement = deepFlatten(element);
      flatArr = flatArr.concat(flattenElement);
    } else {
      flatArr.push(element);
    }
  }
  return flatArr;
};

console.log(deepFlatten(nestedArray));
// 6. Debounce (–û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è)
// –£–º–æ–≤–∞: –ù–∞–ø–∏—à–∏ —Ñ—É–Ω–∫—Ü—ñ—é, —è–∫–∞ –≤—ñ–¥–∫–ª–∞–¥–∞—î –≤–∏–∫–æ–Ω–∞–Ω–Ω—è, –ø–æ–∫–∏ –Ω–µ –º–∏–Ω–µ pause (2000ms) –ø—ñ—Å–ª—è –æ—Å—Ç–∞–Ω–Ω—å–æ–≥–æ –≤–∏–∫–ª–∏–∫—É.
function logData(text) {
  console.log("–ó–∞–ø–∏—Å:", text);
}

function debounce(fn, delay) {
  let timeoutId;

  return function () {
    if (timeoutId) {
      clearTimeout(timeoutId);
    }
    timeoutId = setTimeout(fn, delay);
  };
}

const processChange = debounce(() => logData("–ü—Ä–∏–≤—ñ—Ç"), 2000);
processChange(); // –¢–∞–π–º–µ—Ä –ø—ñ—à–æ–≤
processChange(); // –¢–∞–π–º–µ—Ä —Å–∫–∏–Ω—É–≤—Å—è —ñ –ø—ñ—à–æ–≤ –∑–∞–Ω–æ–≤–æ

/**
 * –ë–õ–û–ö 2: –ù–û–í–Ü –í–ï–†–®–ò–ù–ò (–¢–≤—ñ–π —Å—å–æ–≥–æ–¥–Ω—ñ—à–Ω—ñ–π —à—Ç—Ä–∞—Ñ)
 * –¶—ñ –∑–∞–¥–∞—á—ñ —á–∞—Å—Ç–æ –¥–∞—é—Ç—å –Ω–∞ Junior+ –ø–æ–∑–∏—Ü—ñ—ó.
 */

// 7. Throttle (–û–±–º–µ–∂–µ–Ω–Ω—è —á–∞—Å—Ç–æ—Ç–∏)
// –£–º–æ–≤–∞: –ù–∞ –≤—ñ–¥–º—ñ–Ω—É –≤—ñ–¥ debounce, throttle –¥–æ–∑–≤–æ–ª—è—î –≤–∏–∫–ª–∏–∫–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é –ù–ï –ß–ê–°–¢–Ü–®–ï –Ω—ñ–∂ —Ä–∞–∑ –Ω–∞ N –º—Å.
// –ù–∞–ø—Ä–∏–∫–ª–∞–¥: –ø—Ä–∏ —Å–∫—Ä–æ–ª—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ —Ñ—É–Ω–∫—Ü—ñ—è —Å–ø—Ä–∞—Ü—å–æ–≤—É—î —Ä–∞–∑ –Ω–∞ 500–º—Å, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ —Å–∫—Ä–æ–ª—è—Ç—å –±–µ–∑ –∑—É–ø–∏–Ω–∫–∏.
function throttle(fn, delay) {
  // –¢–≤—ñ–π –∫–æ–¥ —Ç—É—Ç...
}

// 8. –°–≤—ñ–π Array.prototype.myMap
// –£–º–æ–≤–∞: –ù–∞–ø–∏—à–∏ —Å–≤–æ—é —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—é —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ .map() –±–µ–∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –æ—Ä–∏–≥—ñ–Ω–∞–ª—å–Ω–æ–≥–æ –º–µ—Ç–æ–¥—É.
// –§—É–Ω–∫—Ü—ñ—è –º–∞—î –ø—Ä–∏–π–º–∞—Ç–∏ –º–∞—Å–∏–≤ —Ç–∞ –∫–æ–ª–±–µ–∫.
function myMap(arr, callback) {
  // –¢–≤—ñ–π –∫–æ–¥ —Ç—É—Ç...
}

// 9. Infinite Sum (Currying / –†–µ–∫—É—Ä—Å—ñ—è)
// –£–º–æ–≤–∞: –ù–∞–ø–∏—à–∏ —Ñ—É–Ω–∫—Ü—ñ—é sum, —è–∫—É –º–æ–∂–Ω–∞ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –Ω–µ—Å–∫—ñ–Ω—á–µ–Ω–Ω–æ —á–µ—Ä–µ–∑ –¥—É–∂–∫–∏.
// –ü—Ä–∏–∫–ª–∞–¥: sum(1)(2)(3)(4) –º–∞—î –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ —Å—É–º—É –≤—Å—ñ—Ö —á–∏—Å–µ–ª.
// –ü—ñ–¥–∫–∞–∑–∫–∞: —Ñ—É–Ω–∫—Ü—ñ—è –º–∞—î –ø–æ–≤–µ—Ä—Ç–∞—Ç–∏ —Å–∞–º—É —Å–µ–±–µ.
function sum(a) {
  // –¢–≤—ñ–π –∫–æ–¥ —Ç—É—Ç...
}

// –î–æ–º–æ–≤–∏–ª–∏—Å—è! –†–æ–∑–ø–∏—Å—É—é –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –¥–µ—Ç–∞–ª—å–Ω–æ, –∑ –ª–æ–≥—ñ–∫–æ—é —Ç–∞ –ø—ñ–¥–∫–∞–∑–∫–∞–º–∏ (¬´—à–ø–∞—Ä–≥–∞–ª–∫–∞–º–∏¬ª), —â–æ–± —Ç–∏ —Ä–æ–∑—É–º—ñ–≤ –Ω–µ —Ç—ñ–ª—å–∫–∏ —â–æ –ø–∏—Å–∞—Ç–∏, –∞ –π —á–æ–º—É –≤–æ–Ω–æ —Ç–∞–∫ –ø—Ä–∞—Ü—é—î.

// –û—Å—å —Ç–≤—ñ–π —Ñ—Ä–æ–Ω—Ç —Ä–æ–±—ñ—Ç –Ω–∞ –≤–µ—á—ñ—Ä:

// üõ† –ó–∞–¥–∞—á–∞ 8: –°–≤–æ—è —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è .map() (myMap)

// –¶–µ –±–∞–∑–∞. –¢–∏ –º–∞—î—à –ø–æ–∫–∞–∑–∞—Ç–∏, —â–æ —Ä–æ–∑—É–º—ñ—î—à, —è–∫ –ø—Ä–∞—Ü—é—é—Ç—å –º–µ—Ç–æ–¥–∏ –º–∞—Å–∏–≤—ñ–≤ ¬´–ø—ñ–¥ –∫–∞–ø–æ—Ç–æ–º¬ª.

// –£–º–æ–≤–∞: –ù–∞–ø–∏—à–∏ —Ñ—É–Ω–∫—Ü—ñ—é myMap(arr, callback), —è–∫–∞ —Ä–æ–±–∏—Ç—å —Ç–µ —Å–∞–º–µ, —â–æ –π Array.prototype.map.

// –í—Ö—ñ–¥–Ω—ñ –¥–∞–Ω—ñ: 1. arr ‚Äî –º–∞—Å–∏–≤ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, [1, 2, 3]).
// 2. callback ‚Äî —Ñ—É–Ω–∫—Ü—ñ—è, —è–∫–∞ –∫–∞–∂–µ, —â–æ –∑—Ä–æ–±–∏—Ç–∏ –∑ –∫–æ–∂–Ω–∏–º –µ–ª–µ–º–µ–Ω—Ç–æ–º (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, (x) => x * 2).

// –ü—Ä–∞–≤–∏–ª–∞:

// –ù–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –≤–±—É–¥–æ–≤–∞–Ω–∏–π .map().

// –ü–æ–≤–µ—Ä–Ω—É—Ç–∏ –Ω–æ–≤–∏–π –º–∞—Å–∏–≤, –Ω–µ –∑–º—ñ–Ω—é—é—á–∏ —Å—Ç–∞—Ä–∏–π.

// –®–ø–∞—Ä–≥–∞–ª–∫–∞: –¢–æ–±—ñ –∑–Ω–∞–¥–æ–±–∏—Ç—å—Å—è —Ü–∏–∫–ª for –∞–±–æ for...of. –í—Å–µ—Ä–µ–¥–∏–Ω—ñ —Ü–∏–∫–ª—É —Ç–∏ –±–µ—Ä–µ—à –ø–æ—Ç–æ—á–Ω–∏–π –µ–ª–µ–º–µ–Ω—Ç, ¬´–ø—Ä–æ–≥–∞–Ω—è—î—à¬ª –π–æ–≥–æ —á–µ—Ä–µ–∑ callback —ñ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–ª–∞–¥–µ—à —É –Ω–æ–≤–∏–π –º–∞—Å–∏–≤.

function myMap1(arr, callback) {
  const newArr = [];

  for (const element of arr) {
    newArr.push(callback(element));
  }
  return newArr;
}

function myCallback(element) {
  return element * 2;
}

console.log(myMap1([1, 2, 3], myCallback));

// üîó –ù–∞—Å—Ç—É–ø–Ω–∏–π —Ä—ñ–≤–µ–Ω—å: –ù–µ—Å–∫—ñ–Ω—á–µ–Ω–Ω–∞ —Å—É–º–∞ (Currying)

// –¢–∏ –≤–∂–µ –∑–Ω–∞—î—à —Ä–µ–∫—É—Ä—Å—ñ—é (–º–∞—Ç—Ä—å–æ—à–∫—É). –¢—É—Ç –ø—Ä–∏–Ω—Ü–∏–ø —Å—Ö–æ–∂–∏–π, –∞–ª–µ –º–∏ –ø–æ–≤–µ—Ä—Ç–∞—î–º–æ –Ω–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –∞ —Ñ—É–Ω–∫—Ü—ñ—é.

// –¢–≤–æ—è –º–µ—Ç–∞: –Ω–∞–ø–∏—Å–∞—Ç–∏ —Ç–∞–∫—É —Ñ—É–Ω–∫—Ü—ñ—é sum, —â–æ–± —Å–ø—Ä–∞—Ü—é–≤–∞–≤ —Ü–µ–π –ª–∞–Ω—Ü—é–∂–æ–∫:
// sum(1)(5)(10)() // –º–∞—î –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ 16

// –ü—ñ–¥–∫–∞–∑–∫–∞ (–∞–ª–≥–æ—Ä–∏—Ç–º):

// –§—É–Ω–∫—Ü—ñ—è sum(a) –ø–æ–≤–µ—Ä—Ç–∞—î –≤–Ω—É—Ç—Ä—ñ—à–Ω—é —Ñ—É–Ω–∫—Ü—ñ—é (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, inner).

// –¶—è inner(b) –¥–∏–≤–∏—Ç—å—Å—è: ¬´–Ø–∫—â–æ –º–µ–Ω—ñ –ø—Ä–∏—Å–ª–∞–ª–∏ b, —è –≤–∏–∫–ª–∏–∫–∞—é sum(a + b)¬ª.

// ¬´–Ø–∫—â–æ –º–µ–Ω—ñ –Ω—ñ—á–æ–≥–æ –Ω–µ –ø—Ä–∏—Å–ª–∞–ª–∏ (–ø–æ—Ä–æ–∂–Ω—ñ –¥—É–∂–∫–∏), —è –ø—Ä–æ—Å—Ç–æ –ø–æ–≤–µ—Ä—Ç–∞—é a¬ª.

// –°–ø—Ä–æ–±—É–π –Ω–∞–ø–∏—Å–∞—Ç–∏ —Ü–µ. –¢—É—Ç –≤—Å—å–æ–≥–æ 5-6 —Ä—è–¥–∫—ñ–≤ –∫–æ–¥—É, –∞–ª–µ –≤–æ–Ω–∏ –¥—É–∂–µ "–∫–æ–Ω—Ü–µ–Ω—Ç—Ä–æ–≤–∞–Ω—ñ".

function sum1(a) {
  return function (b) {
    if (b) {
      return sum1(a + b);
    } else {
      return a;
    }
  };
}

const res = sum1(10)(5)(10)(3)();
console.log(res);

// THROTTLE

function throttle(fn, delay) {
  let isWaiting = false;

  return function (...args) {
    if (isWaiting) return; // –ó–∞–º–æ–∫ –∑–∞—á–∏–Ω–µ–Ω–æ ‚Äî —Ä–æ–∑–≤–µ—Ä—Ç–∞—î–º–æ—Å—è

    fn(...args); // –í–∏–∫–æ–Ω—É—î–º–æ —Ä–æ–±–æ—Ç—É
    isWaiting = true; // –ó–∞—á–∏–Ω—è—î–º–æ –∑–∞–º–æ–∫

    setTimeout(() => {
      isWaiting = false; // –ß–µ—Ä–µ–∑ delay –≤—ñ–¥—á–∏–Ω—è—î–º–æ –∑–∞–º–æ–∫
    }, delay);
  };
}
